<h1>注文履歴詳細</h1>

<table>
	<tbody>
		<tr>
			<td>購入者</td>
			<td><%= @order.end_user.family_name %><%= @order.end_user.first_name %></td>
		</tr>
		<tr>
			<td>配送先</td>
			<td><%= @order.post_number %><%= @order.address %><%= @order.name %> </td>
		</tr>
		<tr>
			<td>支払い方法</td>
			<td>
				<% if @order.payment == 0 %>
				  <p>クレジットカード</p>
				<% elsif @order.payment ==1 %>
				  <P>銀行振込</P>
				<% else %>
				  <P>支払い方法が選択されていません。</P>
				<% end %>
			</td>
		</tr>
		<tr>
			<td>注文ステータス</td>
			<td>
				<%= form_with(model: @order, url:  admin_order_path(@order.id), method: :put, local: true) do |f| %>
					<%= f.select :order_status, Order.order_statuses_i18n.invert, {} %>
					<%= f.submit '更新' %>
				<% end %>
			</td>
		</tr>
	</tbody>
</table>


	<table border>
		</caption>
		<thead>
			<tr>
				<th>商品名</th>
				<th>単価(税込)</th>
				<th>数量</th>
				<th>小計</th>
				<th>製品ステータス</th>
			</tr>
		</thead>
		<tbody>
			<% @order.order_detiles.each do |order_detile| %>
				<tr>
					<td><%= order_detile.item.name %></td>
					<td><%= order_detile.price %></td>
					<td><%= order_detile.amount %></td>
					<td><%= order_detile.price*order_detile.amount %></td>
					<td>
						<%= form_with(model: order_detile, url:  admin_order_detile_path(order_detile.id), method: :put, local: true) do |f| %>
							<%= f.select :production_status, OrderDetile.production_statuses_i18n.invert, {} %>
							<%= f.submit '更新' %>
						<% end %>
					</td>
				</tr>
			<% end %>
		</tbody>
	</table>

	<table>
		<tbody>
			<tr>
				<td>商品合計</td>
				<td><%= @order.total_price %>円</td>
			</tr>
			<tr>
				<td>送料</td>
				<td><%= @order.postage %>円</td>
			</tr>
			<tr>
				<td>請求金額合計</td>
				<td><%= @order.total_price + @order.postage %>円</td>
			</tr>
		</tbody>
	</table>



